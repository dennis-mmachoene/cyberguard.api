export const incidentResponseModule = {
  moduleId: 'incident-response',
  title: 'Incident Response Fundamentals',
  description: 'Learn how to prepare for, detect, respond to, and recover from security incidents effectively to minimize damage and restore normal operations.',
  level: 'intermediate',
  order: 5,
  content: {
    introduction: 'Security incidents are inevitable. No matter how strong your defenses, breaches can occur through new vulnerabilities, human error, or determined attackers. Incident response is the organized approach to addressing and managing security breaches or attacks. An effective incident response plan minimizes damage, reduces recovery time, and helps organizations learn from incidents to improve security.',
    sections: [
      {
        title: 'The Incident Response Lifecycle',
        content: 'Incident response follows a structured lifecycle with distinct phases. Preparation involves creating plans, training teams, and establishing procedures before incidents occur. Detection and Analysis identifies and confirms security incidents. Containment limits damage by isolating affected systems. Eradication removes the threat from the environment. Recovery restores systems to normal operation. Post-Incident Activity reviews what happened and improves defenses. This cyclical process ensures continuous improvement based on lessons learned.',
        examples: [
          'Preparation: Documented response plan, trained team, communication channels',
          'Detection: SIEM alert on suspicious file encryption activity',
          'Containment: Isolating infected systems from network',
          'Eradication: Removing malware and closing exploited vulnerability',
        ],
        keyPoints: [
          'Incident response is a structured, phased process',
          'Preparation before incidents is critical',
          'Each phase has specific goals and actions',
          'Post-incident review improves future response',
        ],
      },
      {
        title: 'Preparation and Planning',
        content: 'Effective incident response requires preparation before incidents occur. Develop an incident response plan that defines roles, responsibilities, and procedures. Establish an incident response team with representatives from IT, security, legal, communications, and management. Create communication protocols for internal and external stakeholders. Implement logging and monitoring systems to detect incidents. Conduct regular training and simulations to prepare the team. Maintain backups and disaster recovery capabilities. Document critical assets and dependencies. Preparation investment pays dividends when incidents occur.',
        examples: [
          'IR Plan: 50-page document covering all incident types and response procedures',
          'IR Team: Security analyst (technical lead), IT manager, legal counsel, PR representative',
          'Simulation: Tabletop exercise simulating ransomware attack',
          'Tools: Pre-configured forensic workstation and incident response toolkit',
        ],
        keyPoints: [
          'Plans must exist before incidents occur',
          'IR teams need diverse expertise',
          'Regular training keeps teams ready',
          'Documentation and tools enable rapid response',
        ],
      },
      {
        title: 'Detection and Analysis',
        content: 'Early detection limits incident impact. Indicators of Compromise (IOCs) signal potential incidents: unusual network traffic, unexpected system behavior, suspicious file modifications, or alerts from security tools. Incident classification determines severity and priority. Not every event is an incident—analysis distinguishes true positives from false alarms. Document everything during investigation: what was observed, when, and by whom. Initial analysis determines incident scope and impact. Speed matters, but accuracy is critical. Hasty conclusions can misdirect response efforts.',
        examples: [
          'Detection: Antivirus alert on executive laptop',
          'IOC: Unexpected outbound connections to known malicious IPs',
          'Classification: Critical incident—potential data exfiltration',
          'Analysis: Forensic examination reveals credential theft malware',
        ],
        keyPoints: [
          'Early detection reduces incident impact',
          'Not every alert is a real incident',
          'Proper classification guides response priority',
          'Documentation is essential for investigation',
        ],
      },
      {
        title: 'Containment, Eradication, and Recovery',
        content: 'Containment stops incident spread while preserving evidence. Short-term containment provides immediate protection (disconnecting network). Long-term containment enables operations while securing affected systems (network segmentation). Eradication removes the threat: deleting malware, closing vulnerabilities, revoking compromised credentials. Recovery restores normal operations: rebuilding systems from clean backups, applying patches, monitoring for recurrence. Validate recovery before declaring incidents resolved. Each phase requires careful balance between speed and thoroughness.',
        examples: [
          'Containment: Disconnecting infected endpoints from network',
          'Eradication: Reimaging compromised servers from clean backups',
          'Recovery: Gradually restoring services with enhanced monitoring',
          'Validation: Confirming malware removal through clean scans',
        ],
        keyPoints: [
          'Containment prevents spread, preserves evidence',
          'Eradication must address root cause',
          'Recovery requires validation before resuming normal operations',
          'Balance speed with thoroughness',
        ],
      },
      {
        title: 'Post-Incident Activity and Improvement',
        content: 'After resolution, conduct post-incident reviews to extract lessons. What happened? How was it detected? What worked well? What needs improvement? Document timeline, actions taken, and effectiveness. Update incident response plans based on experience. Share lessons learned with relevant teams. Calculate incident costs: downtime, data loss, investigation, remediation, legal, and reputation. Track metrics: time to detection, time to containment, systems affected. Use insights to strengthen defenses and improve response capabilities. Each incident makes the organization more resilient.',
        examples: [
          'Review: Team meeting analyzing ransomware incident response',
          'Lessons: Detection took too long due to insufficient logging',
          'Improvement: Enhanced SIEM rules and added endpoint detection',
          'Metrics: 2-hour detection, 4-hour containment, 24-hour recovery',
        ],
        keyPoints: [
          'Post-incident reviews drive improvement',
          'Document what happened and lessons learned',
          'Update plans based on real experience',
          'Metrics track response effectiveness',
        ],
      },
    ],
    summary: 'Incident response is a structured process for handling security breaches effectively. The lifecycle includes preparation, detection, analysis, containment, eradication, recovery, and post-incident review. Proper preparation with plans, teams, and tools enables rapid, effective response. Documentation and lessons learned continuously improve security posture. While incidents cannot be completely prevented, strong incident response capabilities minimize their impact and support organizational resilience.',
  },
  questions: [
    {
      question: 'What is the first phase of the incident response lifecycle?',
      options: [
        'Detection',
        'Containment',
        'Preparation',
        'Recovery',
      ],
      correctAnswer: 2,
      explanation: 'Preparation is the first phase of the incident response lifecycle. It involves creating plans, training teams, establishing procedures, and setting up monitoring systems before incidents occur. Proper preparation is critical for effective incident response.',
      difficulty: 'easy',
      points: 10,
    },
    {
      question: 'What is an Indicator of Compromise (IOC)?',
      options: [
        'A warning that security has been compromised',
        'Evidence that suggests a system may have been breached',
        'A legal document about data breaches',
        'A type of antivirus software',
      ],
      correctAnswer: 1,
      explanation: 'An Indicator of Compromise (IOC) is evidence or artifact that suggests a system or network may have been breached. IOCs include unusual network traffic, suspicious files, unexpected system behavior, or known malicious signatures. Identifying IOCs helps detect and investigate security incidents.',
      difficulty: 'medium',
      points: 15,
    },
    {
      question: 'What is the primary goal of the containment phase?',
      options: [
        'To delete all evidence',
        'To stop the incident from spreading while preserving evidence',
        'To notify all customers immediately',
        'To restore normal operations',
      ],
      correctAnswer: 1,
      explanation: 'The primary goal of containment is to stop the incident from spreading and limit damage while preserving evidence for investigation. Containment balances immediate protection with the need to understand what happened. Evidence preservation is critical for forensics and legal purposes.',
      difficulty: 'medium',
      points: 15,
    },
    {
      question: 'Why are post-incident reviews important?',
      options: [
        'They are legally required',
        'They help identify who to blame',
        'They provide lessons learned to improve future incident response',
        'They determine financial bonuses',
      ],
      correctAnswer: 2,
      explanation: 'Post-incident reviews are important because they provide lessons learned that improve future incident response. Reviews identify what worked well, what needs improvement, and how to strengthen defenses. This continuous improvement process makes organizations more resilient against future incidents.',
      difficulty: 'easy',
      points: 10,
    },
    {
      question: 'What should happen before declaring an incident fully resolved?',
      options: [
        'Inform the media',
        'Validate that threats are removed and systems are secure',
        'Delete all logs',
        'Immediately resume all normal operations',
      ],
      correctAnswer: 1,
      explanation: 'Before declaring an incident resolved, you must validate that threats are completely removed and systems are secure. This includes confirming malware eradication, verifying system integrity, and monitoring for signs of persistence or reinfection. Premature declaration can lead to recurring incidents.',
      difficulty: 'medium',
      points: 15,
    },
  ],
  estimatedDuration: 25,
  prerequisites: ['malware-types', 'network-security'],
  learningObjectives: [
    'Understand the incident response lifecycle and its phases',
    'Learn how to prepare for security incidents effectively',
    'Recognize indicators of compromise and classify incidents',
    'Understand containment, eradication, and recovery processes',
    'Apply post-incident review to improve security posture',
  ],
  tags: ['incident response', 'security operations', 'forensics', 'recovery', 'intermediate'],
  isActive: true,
  totalPoints: 65,
};

export default incidentResponseModule;