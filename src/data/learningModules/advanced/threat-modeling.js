export const threatModelingModule = {
  moduleId: 'threat-modeling',
  title: 'Threat Modeling and Analysis',
  description: 'Learn systematic approaches to identifying, analyzing, and prioritizing security threats to make informed decisions about risk mitigation.',
  level: 'advanced',
  order: 1,
  content: {
    introduction: 'Threat modeling is a structured approach to identifying potential security threats, understanding their impact, and determining appropriate mitigations. By analyzing systems from an attacker\'s perspective, organizations can proactively address vulnerabilities before they are exploited.',
    sections: [
      {
        title: 'Threat Modeling Fundamentals',
        content: 'Threat modeling identifies what can go wrong with a system and what to do about it. The process involves understanding the system architecture, identifying assets and entry points, enumerating potential threats, assessing risks, and determining countermeasures. Threat modeling should be performed during design phase and updated as systems evolve. Common methodologies include STRIDE (Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege), PASTA (Process for Attack Simulation and Threat Analysis), and attack trees.',
        examples: [
          'STRIDE: Analyzing web application for each threat category',
          'Asset identification: Databases, user credentials, API keys',
          'Entry points: Login form, API endpoints, admin panel',
          'Attack tree: Mapping paths an attacker could take to compromise data',
        ],
        keyPoints: [
          'Threat modeling finds problems before attackers do',
          'Multiple methodologies exist for different contexts',
          'Should be performed early and updated regularly',
          'Focuses on what to protect and from whom',
        ],
      },
      {
        title: 'STRIDE Methodology',
        content: 'STRIDE categorizes threats into six types. Spoofing involves impersonating users or systems. Tampering modifies data or code. Repudiation allows denial of actions taken. Information Disclosure reveals data to unauthorized parties. Denial of Service prevents legitimate access. Elevation of Privilege gains unauthorized capabilities. For each system component, consider each STRIDE category to identify applicable threats. This systematic approach ensures comprehensive threat coverage.',
        examples: [
          'Spoofing: Attacker uses stolen credentials to impersonate admin',
          'Tampering: Man-in-the-middle modifies transaction amounts',
          'Repudiation: User denies making fraudulent purchase',
          'Information Disclosure: SQL injection reveals customer records',
        ],
        keyPoints: [
          'Six threat categories cover common attack types',
          'Apply each category to every system component',
          'Provides structured threat identification',
          'Developed by Microsoft for software security',
        ],
      },
      {
        title: 'Threat Actors and Motivations',
        content: 'Understanding who might attack your system and why helps prioritize defenses. Script kiddies use existing tools with little skill. Hacktivists target organizations for political or social causes. Cybercriminals seek financial gain through fraud, ransomware, or data theft. Nation-state actors conduct espionage or sabotage. Insiders abuse authorized access. Each actor has different capabilities, resources, and motivations. Assess which actors pose realistic threats to your organization based on industry, size, and data value.',
        examples: [
          'Script kiddie: Automated scanning for known vulnerabilities',
          'Hacktivist: DDoS attack on controversial organization',
          'Cybercriminal: Ransomware deployment for profit',
          'Nation-state: Long-term espionage campaign stealing IP',
        ],
        keyPoints: [
          'Different actors have different capabilities',
          'Motivations drive target selection',
          'Not all threats are equally relevant',
          'Tailor defenses to realistic threat actors',
        ],
      },
      {
        title: 'Risk Assessment and Prioritization',
        content: 'Not all threats are equally important. Risk combines likelihood of occurrence with potential impact. High likelihood, high impact threats require immediate attention. Low likelihood, low impact threats may be accepted. Use risk matrices to visualize and compare threats. Consider business impact beyond technical damage: reputation, legal liability, customer trust, operational disruption. Prioritize mitigation efforts on risks exceeding acceptable thresholds. Document accepted risks with justification.',
        examples: [
          'High risk: Unpatched critical vulnerability in public-facing system',
          'Medium risk: Weak password policy allowing credential attacks',
          'Low risk: Physical access to secure data center',
          'Accepted risk: Theoretical attack requiring nation-state resources',
        ],
        keyPoints: [
          'Risk = Likelihood × Impact',
          'Focus resources on highest risks',
          'Consider business impact, not just technical',
          'Document all risk decisions',
        ],
      },
      {
        title: 'Countermeasures and Validation',
        content: 'After identifying and prioritizing threats, determine appropriate countermeasures. Options include eliminating threats through design changes, mitigating through security controls, transferring through insurance or outsourcing, or accepting residual risk. Each countermeasure has costs, effectiveness, and implementation complexity. Validate that implemented countermeasures actually address threats. Threat modeling is iterative—as systems change, revisit threat models. Integrate threat modeling into development lifecycle.',
        examples: [
          'Eliminate: Remove unnecessary admin functionality',
          'Mitigate: Implement rate limiting against brute force',
          'Transfer: Purchase cyber insurance coverage',
          'Accept: Low-probability, low-impact theoretical attacks',
        ],
        keyPoints: [
          'Multiple mitigation strategies exist',
          'Balance effectiveness with cost',
          'Validate countermeasures actually work',
          'Threat models must evolve with systems',
        ],
      },
    ],
    summary: 'Threat modeling systematically identifies security threats and informs risk management decisions. Methodologies like STRIDE provide structured approaches to threat identification. Understanding threat actors and their motivations helps prioritize defenses. Risk assessment balances likelihood and impact. Appropriate countermeasures address threats based on organizational risk tolerance. Regular threat modeling keeps security aligned with evolving systems and threats.',
  },
  questions: [
    {
      question: 'What does the "S" in STRIDE stand for?',
      options: ['Security', 'Spoofing', 'System', 'Scanning'],
      correctAnswer: 1,
      explanation: 'In STRIDE, "S" stands for Spoofing, which involves impersonating users, systems, or data. STRIDE is a threat modeling framework covering Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, and Elevation of Privilege.',
      difficulty: 'easy',
      points: 10,
    },
    {
      question: 'When should threat modeling ideally be performed?',
      options: [
        'Only after security incidents occur',
        'During design phase and updated as systems evolve',
        'Once a year during security audits',
        'Only for systems handling payment data',
      ],
      correctAnswer: 1,
      explanation: 'Threat modeling should ideally be performed during the design phase when changes are less expensive, and updated regularly as systems evolve. Early threat modeling prevents security issues from being built into systems.',
      difficulty: 'medium',
      points: 15,
    },
    {
      question: 'How is security risk typically calculated in threat modeling?',
      options: [
        'Risk = Cost + Time',
        'Risk = Likelihood × Impact',
        'Risk = Vulnerabilities + Threats',
        'Risk = Assets - Controls',
      ],
      correctAnswer: 1,
      explanation: 'Security risk is typically calculated as Likelihood × Impact. This combines the probability that a threat will occur with the potential damage if it does, helping prioritize which risks require the most attention and resources.',
      difficulty: 'medium',
      points: 15,
    },
    {
      question: 'Which threat actor typically has the highest capabilities and resources?',
      options: ['Script kiddies', 'Hacktivists', 'Nation-state actors', 'Cybercriminals'],
      correctAnswer: 2,
      explanation: 'Nation-state actors typically have the highest capabilities and resources, including advanced technical skills, significant funding, time for long-term campaigns, and access to zero-day exploits. However, most organizations face more common threats from cybercriminals and opportunistic attackers.',
      difficulty: 'easy',
      points: 10,
    },
    {
      question: 'What are the four main risk treatment strategies?',
      options: [
        'Analyze, Document, Report, Review',
        'Eliminate, Mitigate, Transfer, Accept',
        'Prevent, Detect, Respond, Recover',
        'Identify, Protect, Detect, Respond',
      ],
      correctAnswer: 1,
      explanation: 'The four main risk treatment strategies are Eliminate (remove the threat through design changes), Mitigate (reduce risk through security controls), Transfer (shift risk to third parties like insurance), and Accept (acknowledge and document residual risk within tolerance).',
      difficulty: 'hard',
      points: 20,
    },
  ],
  estimatedDuration: 30,
  prerequisites: ['malware-types', 'network-security', 'incident-response'],
  learningObjectives: [
    'Understand threat modeling principles and methodologies',
    'Apply STRIDE framework to identify threats',
    'Analyze threat actors and their motivations',
    'Assess and prioritize security risks',
    'Determine appropriate countermeasures for identified threats',
  ],
  tags: ['threat modeling', 'risk assessment', 'stride', 'security analysis', 'advanced'],
  isActive: true,
  totalPoints: 70,
};

export default threatModelingModule;